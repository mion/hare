// Generated by CoffeeScript 1.12.7
(function() {
  var Compiler, directJavaScript;

  Compiler = (function() {
    function Compiler() {}

    Compiler.prototype.compile = function(program) {
      var arglist, args, body, bodyStr, exps, op, rest;
      if (!_.isArray(program)) {
        return directJavaScript(program);
      } else if (_.first(program) === 'do') {
        exps = _.chain(program).drop(1).map(arguments.callee).value();
        body = _.dropRight(exps).concat("return " + (_.last(exps)) + ";");
        bodyStr = body.join(";\n");
        return "(function () { " + bodyStr + " })()";
      } else if (_.first(program) === 'get') {
        return program[1] + "[" + (arguments.callee(program[2])) + "]";
      } else if (_.first(program) === 'set') {
        return program[1] + "[" + (arguments.callee(program[2])) + "] = " + (arguments.callee(program[3]));
      } else if (_.first(program) === 'var') {
        return "var " + program[1] + " = " + (arguments.callee(program[2]));
      } else if (_.first(program) === 'if') {
        return "(" + (arguments.callee(program[1])) + ") ? (" + (arguments.callee(program[2])) + ") : (" + (arguments.callee(program[3])) + ")";
      } else if (program[0] === 'list') {
        return ["["] + _.map(program.slice(1), arguments.callee).join(", ") + ["]"];
      } else if (program[0] === 'func') {
        args = program[1].join(', ');
        rest = _.chain(program).drop(2).map(arguments.callee).value();
        return "function (" + args + ") { return " + rest + "; }";
      } else if (_.includes(['*', '+', '-', '%', '<', '>', '<=', '>=', '=', 'or', 'and'], program[0])) {
        op = '=' === program[0] ? '===' : 'or' === program[0] ? '||' : 'and' === program[0] ? '&&' : program[0];
        return "(" + (arguments.callee(program[1])) + ") " + op + " (" + (arguments.callee(program[2])) + ")";
      } else if (program[0] === 'not') {
        return "!(" + (arguments.callee(program[1])) + ")";
      } else {
        arglist = _.chain(program).tail().map(arguments.callee).value();
        return (directJavaScript(program[0])) + "(" + arglist + ")";
      }
    };

    return Compiler;

  })();

  directJavaScript = function(program) {
    var hareToJs, js, key, value;
    hareToJs = {
      'round': 'Math.round',
      'floor': 'Math.floor',
      'ceiling': 'Math.ceiling',
      '^': 'Math.pow',
      'Ë†': 'Math.pow',
      'sqrt': 'Math.sqrt',
      'max': 'Math.max',
      'min': 'Math.min',
      'cos': 'Math.cos',
      'sin': 'Math.sin',
      'tan': 'Math.tan',
      'acos': 'Math.acos',
      'asin': 'Math.asin',
      'atan': 'Math.atan',
      'log': 'Math.log',
      'log10': 'Math.log10',
      'E': 'Math.E',
      'PI': 'Math.PI',
      'random': 'Math.random'
    };
    for (key in _) {
      value = _[key];
      if (_.hasOwnProperty(key)) {
        hareToJs[key] = "_." + key;
      }
    }
    js = hareToJs[program];
    if (_.isUndefined(js)) {
      return program;
    } else {
      return js;
    }
  };

  module.exports = {
    Compiler: Compiler,
    compile: function(program) {
      var compiler;
      compiler = new Compiler();
      return compiler.compile(program);
    }
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcGlsZXIuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzIjpbInNyY19jb2ZmZWUvY29tcGlsZXIuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUFBLE1BQUE7O0VBQU07SUFDUyxrQkFBQSxHQUFBOzt1QkFDYixPQUFBLEdBQVMsU0FBQyxPQUFEO0FBQ1AsVUFBQTtNQUFBLElBQUcsQ0FBSSxDQUFDLENBQUMsT0FBRixDQUFVLE9BQVYsQ0FBUDtlQUNFLGdCQUFBLENBQWlCLE9BQWpCLEVBREY7T0FBQSxNQUVLLElBQUcsQ0FBQyxDQUFDLEtBQUYsQ0FBUSxPQUFSLENBQUEsS0FBb0IsSUFBdkI7UUFDSCxJQUFBLEdBQU8sQ0FBQyxDQUFDLEtBQUYsQ0FBUSxPQUFSLENBQWdCLENBQUMsSUFBakIsQ0FBc0IsQ0FBdEIsQ0FBd0IsQ0FBQyxHQUF6QixDQUE2QixTQUFTLENBQUMsTUFBdkMsQ0FBOEMsQ0FBQyxLQUEvQyxDQUFBO1FBQ1AsSUFBQSxHQUFPLENBQUMsQ0FBQyxTQUFGLENBQVksSUFBWixDQUFpQixDQUFDLE1BQWxCLENBQXlCLFNBQUEsR0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFGLENBQU8sSUFBUCxDQUFELENBQVQsR0FBdUIsR0FBaEQ7UUFDUCxPQUFBLEdBQVUsSUFBSSxDQUFDLElBQUwsQ0FBVSxLQUFWO2VBQ1YsaUJBQUEsR0FBa0IsT0FBbEIsR0FBMEIsUUFKdkI7T0FBQSxNQUtBLElBQUcsQ0FBQyxDQUFDLEtBQUYsQ0FBUSxPQUFSLENBQUEsS0FBb0IsS0FBdkI7ZUFDQSxPQUFRLENBQUEsQ0FBQSxDQUFULEdBQVksR0FBWixHQUFjLENBQUMsU0FBUyxDQUFDLE1BQVYsQ0FBaUIsT0FBUSxDQUFBLENBQUEsQ0FBekIsQ0FBRCxDQUFkLEdBQTRDLElBRDNDO09BQUEsTUFFQSxJQUFHLENBQUMsQ0FBQyxLQUFGLENBQVEsT0FBUixDQUFBLEtBQW9CLEtBQXZCO2VBQ0EsT0FBUSxDQUFBLENBQUEsQ0FBVCxH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Q0U7SUFBQSxRQUFBLEVBQVUsUUFBVjtJQUNBLE9BQUEsRUFBUyxTQUFDLE9BQUQ7QUFDUCxVQUFBO01BQUEsUUFBQSxHQUFXLElBQUksUUFBSixDQUFBO2FBQ1gsUUFBUSxDQUFDLE9BQVQsQ0FBaUIsT0FBakI7SUFGTyxDQURUOztBQXBFRiIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIENvbXBpbGVyXG4gIGNvbnN0cnVjdG9yOiAoKSAtPlxuICBjb21waWxlOiAocHJvZ3JhbSkgLT5cbiAgICBpZiBub3QgXy5pc0FycmF5KHByb2dyYW0pXG4gICAgICBkaXJlY3RKYXZhU2NyaXB0KHByb2dyYW0pXG4gICAgZWxzZSBpZiBfLmZpcnN0KHByb2dyYW0pID09ICdkbydcbiAgICAgIGV4cHMgPSBfLmNoYWluKHByb2dyYW0pLmRyb3AoMSkubWFwKGFyZ3VtZW50cy5jYWxsZWUpLnZhbHVlKClcbiAgICAgIGJvZHkgPSBfLmRyb3BSaWdodChleHBzKS5jb25jYXQoXCJyZXR1cm4gI3tfLmxhc3QoZXhwcyl9O1wiKVxuICAgICAgYm9keVN0ciA9IGJvZHkuam9pbihcIjtcXG5cIilcbiAgICAgIFwiKGZ1bmN0aW9uICgpIHsgI3tib2R5U3RyfSB9KSgpXCJcbiAgICBlbHNlIGlmIF8uZmlyc3QocHJvZ3JhbSkgPT0gJ2dldCcgIyAoZ2V0IGFycmF5IDIpIC0+IGFycmF5WzJdXG4gICAgICBcIiN7cHJvZ3JhbVsxXX1bI3thcmd1bWVudHMuY2FsbGVlKHByb2dyYW1bMl0pfV1cIlxuICAgIGVsc2UgaWYgXy5maXJzdChwcm9ncmFtKSA9PSAnc2V0JyAjIChzZXQgYXJyYXkgMiBcImZvb1wiKSAtPiBhcnJheVsyXSA9IFwiZm9vXCJcbiAgICAgIFwiI3twcm9ncmFtWzFdfVsje2FyZ3VtZW50cy5jYWxsZWUocHJvZ3JhbVsyXSl9XSA9ICN7YXJndW1lbnRzLmNhbGxlZShwcm9ncmFtWzNdKX1cIlxuICAgIGVsc2UgaWYgXy5maXJzdChwcm9ncmFtKSA9PSAndmFyJ1xuICAgICAgXCJ2YXIgI3twcm9ncmFtWzFdfSA9ICN7YXJndW1lbnRzLmNhbGxlZShwcm9ncmFtWzJdKX1cIlxuICAgIGVsc2UgaWYgXy5maXJzdChwcm9ncmFtKSA9PSAnaWYnXG4gICAgICBcIigje2FyZ3VtZW50cy5jYWxsZWUocHJvZ3JhbVsxXSl9KSA/ICgje2FyZ3VtZW50cy5jYWxsZWUocHJvZ3JhbVsyXSl9KSA6ICgje2FyZ3VtZW50cy5jYWxsZWUocHJvZ3JhbVszXSl9KVwiXG4gICAgZWxzZSBpZiBwcm9ncmFtWzBdID09ICdsaXN0J1xuICAgICAgW1wiW1wiXSArIF8ubWFwKHByb2dyYW0uc2xpY2UoMSksIGFyZ3VtZW50cy5jYWxsZWUpLmpvaW4oXCIsIFwiKSArIFtcIl1cIl1cbiAgICBlbHNlIGlmIHByb2dyYW1bMF0gPT0gJ2Z1bmMnXG4gICAgICBhcmdzID0gcHJvZ3JhbVsxXS5qb2luKCcsICcpXG4gICAgICByZXN0ID0gXy5jaGFpbihwcm9ncmFtKS5kcm9wKDIpLm1hcChhcmd1bWVudHMuY2FsbGVlKS52YWx1ZSgpXG4gICAgICBcImZ1bmN0aW9uICgje2FyZ3N9KSB7IHJldHVybiAje3Jlc3R9OyB9XCJcbiAgICBlbHNlIGlmIF8uaW5jbHVkZXMoWycqJywgJysnLCAnLScsICclJywgJzwnLCAnPicsICc8PScsICc+PScsICc9JywgJ29yJywgJ2FuZCddLCBwcm9ncmFtWzBdKVxuICAgICAgb3AgPSBpZiAnPScgPT0gcHJvZ3JhbVswXVxuICAgICAgICAnPT09J1xuICAgICAgZWxzZSBpZiAnb3InID09IHByb2dyYW1bMF1cbiAgICAgICAgJ3x8J1xuICAgICAgZWxzZSBpZiAnYW5kJyA9PSBwcm9ncmFtWzBdXG4gICAgICAgICcmJidcbiAgICAgIGVsc2VcbiAgICAgICAgcHJvZ3JhbVswXVxuICAgICAgXCIoI3thcmd1bWVudHMuY2FsbGVlKHByb2dyYW1bMV0pfSkgI3tvcH0gKCN7YXJndW1lbnRzLmNhbGxlZShwcm9ncmFtWzJdKX0pXCJcbiAgICBlbHNlIGlmIHByb2dyYW1bMF0gPT0gJ25vdCdcbiAgICAgIFwiISgje2FyZ3VtZW50cy5jYWxsZWUocHJvZ3JhbVsxXSl9KVwiXG4gICAgZWxzZVxuICAgICAgYXJnbGlzdCA9IF8uY2hhaW4ocHJvZ3JhbSkudGFpbCgpLm1hcChhcmd1bWVudHMuY2FsbGVlKS52YWx1ZSgpXG4gICAgICBcIiN7ZGlyZWN0SmF2YVNjcmlwdChwcm9ncmFtWzBdKX0oI3thcmdsaXN0fSlcIlxuXG5kaXJlY3RKYXZhU2NyaXB0ID0gKHByb2dyYW0pIC0+XG4gIGhhcmVUb0pzID1cbiAgICAncm91bmQnOiAnTWF0aC5yb3VuZCdcbiAgICAnZmxvb3InOiAnTWF0aC5mbG9vcidcbiAgICAnY2VpbGluZyc6ICdNYXRoLmNlaWxpbmcnXG4gICAgJ14nOiAnTWF0aC5wb3cnXG4gICAgJ8uGJzogJ01hdGgucG93J1xuICAgICdzcXJ0JzogJ01hdGguc3FydCdcbiAgICAnbWF4JzogJ01hdGgubWF4J1xuICAgICdtaW4nOiAnTWF0aC5taW4nXG4gICAgJ2Nvcyc6ICdNYXRoLmNvcydcbiAgICAnc2luJzogJ01hdGguc2luJ1xuICAgICd0YW4nOiAnTWF0aC50YW4nXG4gICAgJ2Fjb3MnOiAnTWF0aC5hY29zJ1xuICAgICdhc2luJzogJ01hdGguYXNpbidcbiAgICAnYXRhbic6ICdNYXRoLmF0YW4nXG4gICAgJ2xvZyc6ICdNYXRoLmxvZydcbiAgICAnbG9nMTAnOiAnTWF0aC5sb2cxMCdcbiAgICAnRSc6ICdNYXRoLkUnXG4gICAgJ1BJJzogJ01hdGguUEknXG4gICAgJ3JhbmRvbSc6ICdNYXRoLnJhbmRvbSdcbiAgZm9yIGtleSwgdmFsdWUgb2YgX1xuICAgIGlmIF8uaGFzT3duUHJvcGVydHkoa2V5KVxuICAgICAgaGFyZVRvSnNba2V5XSA9IFwiXy4je2tleX1cIlxuICBqcyA9IGhhcmVUb0pzW3Byb2dyYW1dXG4gIGlmIF8uaXNVbmRlZmluZWQoanMpIHRoZW4gcHJvZ3JhbSBlbHNlIGpzXG5cbm1vZHVsZS5leHBvcnRzID1cbiAgQ29tcGlsZXI6IENvbXBpbGVyXG4gIGNvbXBpbGU6IChwcm9ncmFtKSAtPlxuICAgIGNvbXBpbGVyID0gbmV3IENvbXBpbGVyKClcbiAgICBjb21waWxlci5jb21waWxlKHByb2dyYW0pXG4iXX0=
//# sourceURL=/Users/gvieira/code/hare/hare_framer/src_coffee/compiler.coffee