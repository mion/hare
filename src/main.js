// Generated by CoffeeScript 1.12.7
(function() {
  var Editor, Key, KeyHandler, SAtom, SExpression, SList, Token, __, editor, evaluate, inconsolata, keyHandler, parse, render, test,
    slice = [].slice,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  __ = require('./utils');

  inconsolata = Utils.loadWebFont("Inconsolata");

  parse = function(string) {
    var tokens;
    tokens = string.replace(/\(/g, "( ").replace(/\)/g, " )").split(" ").filter(function(str) {
      return str !== "";
    });
    return tokens;
  };

  test = function() {
    var actual, args, expected, fn, i;
    fn = arguments[0], args = 3 <= arguments.length ? slice.call(arguments, 1, i = arguments.length - 1) : (i = 1, []), expected = arguments[i++];
    actual = fn.apply(null, args);
    if (_.isEqual(actual, expected)) {
      return console.log("[*] Test OK");
    } else {
      return console.log("[!] Test failed!\n    Expected: `" + expected + "` (" + (typeof expected) + ")\n    Actual: `" + actual + "` (" + (typeof actual) + ")");
    }
  };

  test(parse, "hi", "hi");

  test(parse, "()", []);

  test(parse, "(hi)", ["hi"]);

  test(parse, "(hello there)", ["hello", "there"]);

  test(parse, "(hello (my good) old friend ())", ["hello", ["my", "good"], "old", "friend", []]);

  window.parseHare = parse;

  SExpression = (function() {
    function SExpression(tokens1, parent1) {
      var sibling;
      this.tokens = tokens1;
      this.parent = parent1;
      this.children = [];
      this.previous = null;
      this.next = null;
      if (!_.isNil(this.parent)) {
        if (!_.isEmpty(this.parent.children)) {
          sibling = _.last(this.parent.children);
          this.previous = sibling;
          sibling.next = this;
        }
        this.parent.children.push(this);
      }
    }

    SExpression.prototype.select = function() {
      return _.each(this.tokens, function(token) {
        return token.select();
      });
    };

    SExpression.prototype.deselect = function() {
      return _.each(this.tokens, function(token) {
        return token.deselect();
      });
    };

    return SExpression;

  })();

  SAtom = (function(superClass) {
    extend(SAtom, superClass);

    function SAtom(token, parent) {
      SAtom.__super__.constructor.call(this, [token], parent);
    }

    return SAtom;

  })(SExpression);

  SList = (function(superClass) {
    extend(SList, superClass);

    function SList(tokens, parent) {
      SList.__super__.constructor.call(this, tokens, parent);
    }

    return SList;

  })(SExpression);

  Token = (function(superClass) {
    extend(Token, superClass);

    Token.prototype.DESELECTED_COLOR = '#F5F5F5';

    Token.prototype.SELECTED_COLOR = '#F5F500';

    function Token(txt, x, y) {
      Token.__super__.constructor.call(this, {
        text: txt,
        fontSize: 20,
        fontFamily: inconsolata,
        textAlign: 'center',
        x: x,
        y: y,
        color: '#000000',
        backgroundColor: this.DESELECTED_COLOR,
        borderWidth: 1,
        borderColor: '#F2F2F2',
        padding: 10
      });
    }

    Token.prototype.select = function() {
      return this.backgroundColor = this.SELECTED_COLOR;
    };

    Token.prototype.deselect = function() {
      return this.backgroundColor = this.DESELECTED_COLOR;
    };

    return Token;

  })(TextLayer);

  evaluate = function(sexp) {
    var args, operator, thing;
    if (!(_.isArray(sexp) && sexp.length > 0)) {
      return sexp;
    }
    operator = _.head(sexp);
    args = _.tail(sexp);
    if (operator === 'quote') {
      if (args.length === 1) {
        return args[0];
      } else {
        return "ERROR: wrong numbers of arguments";
      }
    }
    if (operator === 'atom') {
      if (args.length === 1) {
        thing = evaluate(args[0]);
        if ((_.isArray(thing) && _.isEmpty(thing)) || _.isString(thing)) {
          return 't';
        } else {
          return [];
        }
      } else {
        return "ERROR: wrong numbers of arguments";
      }
    }
  };

  window.evaluate = evaluate;

  render = function(exp, x, y, tokens, parentSExp) {
    var lastToken, leftParens, leftParensIndex, rightParens, slist, str;
    if (_.isString(exp)) {
      str = new Token(exp, x, y);
      tokens.push(str);
      return new SAtom(str, parentSExp);
    } else {
      leftParens = new Token("(", x, y);
      tokens.push(leftParens);
      leftParensIndex = tokens.length - 1;
      slist = new SList([], parentSExp);
      _.each(exp, function(e) {
        var lastToken;
        lastToken = _.last(tokens);
        return render(e, __.xRight(lastToken), y, tokens, slist);
      });
      lastToken = _.last(tokens);
      rightParens = new Token(")", __.xRight(lastToken), y);
      tokens.push(rightParens);
      slist.tokens = tokens.slice(leftParensIndex);
      return slist;
    }
  };

  Editor = (function() {
    function Editor() {
      this.program = [['lambda', ['x'], ['cons', 'x', ['quote', ['b']]]]];
      this.rootSExp = render(this.program, 50, 100, []);
      this.currentSExp = null;
      console.log(this.rootSExp);
    }

    Editor.prototype.goNext = function() {
      if (_.isNil(this.currentSExp)) {
        return;
      }
      if (_.isNil(this.currentSExp.next)) {
        return;
      }
      this.currentSExp.deselect();
      this.currentSExp = this.currentSExp.next;
      return this.currentSExp.select();
    };

    Editor.prototype.goPrevious = function() {
      if (_.isNil(this.currentSExp)) {
        return;
      }
      if (_.isNil(this.currentSExp.previous)) {
        return;
      }
      this.currentSExp.deselect();
      this.currentSExp = this.currentSExp.previous;
      return this.currentSExp.select();
    };

    Editor.prototype.goIn = function() {
      if (_.isNil(this.currentSExp)) {
        this.currentSExp = this.rootSExp;
        return this.currentSExp.select();
      } else {
        if (!_.isEmpty(this.currentSExp.children)) {
          this.currentSExp.deselect();
          this.currentSExp = _.first(this.currentSExp.children);
          return this.currentSExp.select();
        }
      }
    };

    Editor.prototype.goOut = function() {
      if (_.isNil(this.currentSExp)) {
        return;
      }
      this.currentSExp.deselect();
      this.currentSExp = this.currentSExp.parent;
      if (!_.isNil(this.currentSExp)) {
        return this.currentSExp.select();
      }
    };

    return Editor;

  })();

  editor = new Editor;

  Key = {
    LEFT: 72,
    RIGHT: 76,
    UP: 75,
    DOWN: 74,
    SPACE: 32,
    ENTER: 13
  };

  KeyHandler = (function() {
    function KeyHandler(editor1) {
      this.editor = editor1;
      Events.wrap(window).addEventListener('keydown', (function(_this) {
        return function(event) {
          console.log('key code', event.keyCode);
          if (event.keyCode === Key.DOWN) {
            _this.editor.goIn();
          }
          if (event.keyCode === Key.UP) {
            _this.editor.goOut();
          }
          if (event.keyCode === Key.RIGHT) {
            _this.editor.goNext();
          }
          if (event.keyCode === Key.LEFT) {
            return _this.editor.goPrevious();
          }
        };
      })(this));
    }

    return KeyHandler;

  })();

  keyHandler = new KeyHandler(editor);

  console.log('running...');

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIuLiIsInNvdXJjZXMiOlsic3JjX2NvZmZlZS9tYWluLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBR0E7QUFBQSxNQUFBLDZIQUFBO0lBQUE7Ozs7RUFBQSxFQUFBLEdBQUssT0FBQSxDQUFRLFNBQVI7O0VBRUwsV0FBQSxHQUFjLEtBQUssQ0FBQyxXQUFOLENBQWtCLGFBQWxCOztFQUVkLEtBQUEsR0FBUSxTQUFDLE1BQUQ7QUFDTixRQUFBO0lBQUEsTUFBQSxHQUFTLE1BQU0sQ0FBQyxPQUFQLENBQWUsS0FBZixFQUFzQixJQUF0QixDQUEyQixDQUFDLE9BQTVCLENBQW9DLEtBQXBDLEVBQTJDLElBQTNDLENBQWdELENBQUMsS0FBakQsQ0FBdUQsR0FBdkQsQ0FBMkQsQ0FBQyxNQUE1RCxDQUFtRSxTQUFDLEdBQUQ7YUFBUyxHQUFBLEtBQVM7SUFBbEIsQ0FBbkU7V0FDVDtFQUZNOztFQUlSLElBQUEsR0FBTyxTQUFBO0FBQ0wsUUFBQTtJQURNLG1CQUFJLGlHQUFTO0lBQ25CLE1BQUEsR0FBUyxFQUFBLGFBQUcsSUFBSDtJQUNULElBQUcsQ0FBQyxDQUFDLE9BQUYsQ0FBVSxNQUFWLEVBQWtCLFFBQWxCLENBQUg7YUFDRSxPQUFPLENBQUMsR0FBUixDQUFZLGFBQVosRUFERjtLQUFBLE1BQUE7YUFHRSxPQUFPLENBQUMsR0FBUixDQUFZLG1DQUFBLEdBQW9DLFFBQXBDLEdBQTZDLEtBQTdDLEdBQWlELENBQUMsT0FBTyxRQUFSLENBQWpELEdBQWtFLGtCQUFsRSxHQUFvRixNQUFwRixHQUEyRixLQUEzRixHQUErRixDQUFDLE9BQU8sTUFBUixDQUEvRixHQUE4RyxHQUExSCxFQUhGOztFQUZLOztFQU9QLElBQUEsQ0FBSyxLQUFMLEVBQVksSUFBWixFQUFrQixJQUFsQjs7RUFDQSxJQUFBLENBQUssS0FBTCxFQUFZLElBQVosRUFBa0IsRUFBbEI7O0VBQ0EsSUFBQSxDQUFLLEtBQUwsRUFBWSxNQUFa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TyxDQUFDLEdBQVIsQ0FBWSxZQUFaO0FBbktBIiwic291cmNlc0NvbnRlbnQiOlsiIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXG4jIEltcG9ydHNcbiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xuX18gPSByZXF1aXJlICcuL3V0aWxzJ1xuXG5pbmNvbnNvbGF0YSA9IFV0aWxzLmxvYWRXZWJGb250KFwiSW5jb25zb2xhdGFcIilcblxucGFyc2UgPSAoc3RyaW5nKSAtPlxuICB0b2tlbnMgPSBzdHJpbmcucmVwbGFjZSgvXFwoL2csIFwiKCBcIikucmVwbGFjZSgvXFwpL2csIFwiIClcIikuc3BsaXQoXCIgXCIpLmZpbHRlciAoc3RyKSAtPiBzdHIgaXNudCBcIlwiXG4gIHRva2Vuc1xuXG50ZXN0ID0gKGZuLCBhcmdzLi4uLCBleHBlY3RlZCkgLT5cbiAgYWN0dWFsID0gZm4oYXJncy4uLilcbiAgaWYgXy5pc0VxdWFsKGFjdHVhbCwgZXhwZWN0ZWQpXG4gICAgY29uc29sZS5sb2cgXCJbKl0gVGVzdCBPS1wiXG4gIGVsc2VcbiAgICBjb25zb2xlLmxvZyBcIlshXSBUZXN0IGZhaWxlZCFcXG4gICAgRXhwZWN0ZWQ6IGAje2V4cGVjdGVkfWAgKCN7dHlwZW9mIGV4cGVjdGVkfSlcXG4gICAgQWN0dWFsOiBgI3thY3R1YWx9YCAoI3t0eXBlb2YgYWN0dWFsfSlcIlxuXG50ZXN0IHBhcnNlLCBcImhpXCIsIFwiaGlcIlxudGVzdCBwYXJzZSwgXCIoKVwiLCBbXVxudGVzdCBwYXJzZSwgXCIoaGkpXCIsIFtcImhpXCJdXG50ZXN0IHBhcnNlLCBcIihoZWxsbyB0aGVyZSlcIiwgW1wiaGVsbG9cIiwgXCJ0aGVyZVwiXVxudGVzdCBwYXJzZSwgXCIoaGVsbG8gKG15IGdvb2QpIG9sZCBmcmllbmQgKCkpXCIsIFtcImhlbGxvXCIsIFtcIm15XCIsIFwiZ29vZFwiXSwgXCJvbGRcIiwgXCJmcmllbmRcIiwgW11dXG5cbndpbmRvdy5wYXJzZUhhcmUgPSBwYXJzZVxuXG5jbGFzcyBTRXhwcmVzc2lvblxuICBjb25zdHJ1Y3RvcjogKEB0b2tlbnMsIEBwYXJlbnQpIC0+XG4gICAgQGNoaWxkcmVuID0gW11cbiAgICBAcHJldmlvdXMgPSBudWxsXG4gICAgQG5leHQgPSBudWxsXG4gICAgaWYgbm90IF8uaXNOaWwoQHBhcmVudClcbiAgICAgIGlmIG5vdCBfLmlzRW1wdHkoQHBhcmVudC5jaGlsZHJlbilcbiAgICAgICAgc2libGluZyA9IF8ubGFzdChAcGFyZW50LmNoaWxkcmVuKVxuICAgICAgICBAcHJldmlvdXMgPSBzaWJsaW5nXG4gICAgICAgIHNpYmxpbmcubmV4dCA9IHRoaXNcbiAgICAgIEBwYXJlbnQuY2hpbGRyZW4ucHVzaCh0aGlzKVxuICBzZWxlY3Q6ICgpIC0+XG4gICAgXy5lYWNoIEB0b2tlbnMsICh0b2tlbikgLT4gdG9rZW4uc2VsZWN0KClcbiAgZGVzZWxlY3Q6ICgpIC0+XG4gICAgXy5lYWNoIEB0b2tlbnMsICh0b2tlbikgLT4gdG9rZW4uZGVzZWxlY3QoKVxuXG5jbGFzcyBTQXRvbSBleHRlbmRzIFNFeHByZXNzaW9uXG4gIGNvbnN0cnVjdG9yOiAodG9rZW4sIHBhcmVudCkgLT5cbiAgICBzdXBlciBbdG9rZW5dLCBwYXJlbnRcblxuY2xhc3MgU0xpc3QgZXh0ZW5kcyBTRXhwcmVzc2lvblxuICBjb25zdHJ1Y3RvcjogKHRva2VucywgcGFyZW50KSAtPlxuICAgIHN1cGVyIHRva2VucywgcGFyZW50XG5cbmNsYXNzIFRva2VuIGV4dGVuZHMgVGV4dExheWVyXG4gIERFU0VMRUNURURfQ09MT1I6ICcjRjVGNUY1J1xuICBTRUxFQ1RFRF9DT0xPUjogJyNGNUY1MDAnXG4gIGNvbnN0cnVjdG9yOiAodHh0LCB4LCB5KSAtPlxuICAgIHN1cGVyXG4gICAgICB0ZXh0OiB0eHRcbiAgICAgIGZvbnRTaXplOiAyMFxuICAgICAgZm9udEZhbWlseTogaW5jb25zb2xhdGFcbiAgICAgIHRleHRBbGlnbjogJ2NlbnRlcidcbiAgICAgIHg6IHhcbiAgICAgIHk6IHlcbiAgICAgIGNvbG9yOiAnIzAwMDAwMCdcbiAgICAgIGJhY2tncm91bmRDb2xvcjogQERFU0VMRUNURURfQ09MT1JcbiAgICAgIGJvcmRlcldpZHRoOiAxXG4gICAgICBib3JkZXJDb2xvcjogJyNGMkYyRjInXG4gICAgICBwYWRkaW5nOiAxMFxuICBzZWxlY3Q6ICgpIC0+XG4gICAgQGJhY2tncm91bmRDb2xvciA9IEBTRUxFQ1RFRF9DT0xPUlxuICBkZXNlbGVjdDogKCkgLT5cbiAgICBAYmFja2dyb3VuZENvbG9yID0gQERFU0VMRUNURURfQ09MT1JcblxuZXZhbHVhdGUgPSAoc2V4cCkgLT5cbiAgcmV0dXJuIHNleHAgdW5sZXNzIF8uaXNBcnJheShzZXhwKSAmJiBzZXhwLmxlbmd0aCA+IDBcbiAgb3BlcmF0b3IgPSBfLmhlYWQoc2V4cClcbiAgYXJncyA9IF8udGFpbChzZXhwKVxuICBpZiBvcGVyYXRvciBpcyAncXVvdGUnXG4gICAgaWYgYXJncy5sZW5ndGggPT0gMVxuICAgICAgcmV0dXJuIGFyZ3NbMF1cbiAgICBlbHNlXG4gICAgICByZXR1cm4gXCJFUlJPUjogd3JvbmcgbnVtYmVycyBvZiBhcmd1bWVudHNcIlxuICBpZiBvcGVyYXRvciBpcyAnYXRvbSdcbiAgICBpZiBhcmdzLmxlbmd0aCA9PSAxXG4gICAgICB0aGluZyA9IGV2YWx1YXRlKGFyZ3NbMF0pXG4gICAgICByZXR1cm4gaWYgKF8uaXNBcnJheSh0aGluZykgYW5kIF8uaXNFbXB0eSh0aGluZykpIG9yIF8uaXNTdHJpbmcodGhpbmcpIHRoZW4gJ3QnIGVsc2UgW11cbiAgICBlbHNlXG4gICAgICByZXR1cm4gXCJFUlJPUjogd3JvbmcgbnVtYmVycyBvZiBhcmd1bWVudHNcIlxuXG53aW5kb3cuZXZhbHVhdGUgPSBldmFsdWF0ZVxuXG5yZW5kZXIgPSAoZXhwLCB4LCB5LCB0b2tlbnMsIHBhcmVudFNFeHApIC0+XG4gIGlmIF8uaXNTdHJpbmcoZXhwKVxuICAgIHN0ciA9IG5ldyBUb2tlbihleHAsIHgsIHkpXG4gICAgdG9rZW5zLnB1c2goc3RyKVxuICAgIHJldHVybiBuZXcgU0F0b20oc3RyLCBwYXJlbnRTRXhwKVxuICBlbHNlXG4gICAgbGVmdFBhcmVucyA9IG5ldyBUb2tlbihcIihcIiwgeCwgeSlcbiAgICB0b2tlbnMucHVzaChsZWZ0UGFyZW5zKVxuICAgIGxlZnRQYXJlbnNJbmRleCA9IHRva2Vucy5sZW5ndGggLSAxXG4gICAgc2xpc3QgPSBuZXcgU0xpc3QoW10sIHBhcmVudFNFeHApXG4gICAgXy5lYWNoIGV4cCwgKGUpIC0+XG4gICAgICBsYXN0VG9rZW4gPSBfLmxhc3QodG9rZW5zKVxuICAgICAgcmVuZGVyKGUsIF9fLnhSaWdodChsYXN0VG9rZW4pLCB5LCB0b2tlbnMsIHNsaXN0KVxuICAgIGxhc3RUb2tlbiA9IF8ubGFzdCh0b2tlbnMpXG4gICAgcmlnaHRQYXJlbnMgPSBuZXcgVG9rZW4oXCIpXCIsIF9fLnhSaWdodChsYXN0VG9rZW4pLCB5KVxuICAgIHRva2Vucy5wdXNoKHJpZ2h0UGFyZW5zKVxuICAgIHNsaXN0LnRva2VucyA9IHRva2Vucy5zbGljZShsZWZ0UGFyZW5zSW5kZXgpXG4gICAgcmV0dXJuIHNsaXN0XG5cbmNsYXNzIEVkaXRvclxuICBjb25zdHJ1Y3RvcjogKCkgLT5cbiAgICBAcHJvZ3JhbSA9IFtbJ2xhbWJkYScsIFsneCddLCBbJ2NvbnMnLCAneCcsIFsncXVvdGUnLCBbJ2InXV1dXV1cbiAgICBAcm9vdFNFeHAgPSByZW5kZXIgQHByb2dyYW0sIDUwLCAxMDAsIFtdXG4gICAgQGN1cnJlbnRTRXhwID0gbnVsbFxuICAgIGNvbnNvbGUubG9nKEByb290U0V4cClcbiAgZ29OZXh0OiAoKSAtPlxuICAgIHJldHVybiBpZiBfLmlzTmlsKEBjdXJyZW50U0V4cClcbiAgICByZXR1cm4gaWYgXy5pc05pbChAY3VycmVudFNFeHAubmV4dClcbiAgICBAY3VycmVudFNFeHAuZGVzZWxlY3QoKVxuICAgIEBjdXJyZW50U0V4cCA9IEBjdXJyZW50U0V4cC5uZXh0XG4gICAgQGN1cnJlbnRTRXhwLnNlbGVjdCgpXG4gIGdvUHJldmlvdXM6ICgpIC0+XG4gICAgcmV0dXJuIGlmIF8uaXNOaWwoQGN1cnJlbnRTRXhwKVxuICAgIHJldHVybiBpZiBfLmlzTmlsKEBjdXJyZW50U0V4cC5wcmV2aW91cylcbiAgICBAY3VycmVudFNFeHAuZGVzZWxlY3QoKVxuICAgIEBjdXJyZW50U0V4cCA9IEBjdXJyZW50U0V4cC5wcmV2aW91c1xuICAgIEBjdXJyZW50U0V4cC5zZWxlY3QoKVxuICBnb0luOiAoKSAtPlxuICAgIGlmIF8uaXNOaWwoQGN1cnJlbnRTRXhwKVxuICAgICAgQGN1cnJlbnRTRXhwID0gQHJvb3RTRXhwXG4gICAgICBAY3VycmVudFNFeHAuc2VsZWN0KClcbiAgICBlbHNlXG4gICAgICBpZiBub3QgXy5pc0VtcHR5KEBjdXJyZW50U0V4cC5jaGlsZHJlbilcbiAgICAgICAgQGN1cnJlbnRTRXhwLmRlc2VsZWN0KClcbiAgICAgICAgQGN1cnJlbnRTRXhwID0gXy5maXJzdChAY3VycmVudFNFeHAuY2hpbGRyZW4pXG4gICAgICAgIEBjdXJyZW50U0V4cC5zZWxlY3QoKVxuICBnb091dDogKCkgLT5cbiAgICByZXR1cm4gaWYgXy5pc05pbChAY3VycmVudFNFeHApXG4gICAgQGN1cnJlbnRTRXhwLmRlc2VsZWN0KClcbiAgICBAY3VycmVudFNFeHAgPSBAY3VycmVudFNFeHAucGFyZW50XG4gICAgQGN1cnJlbnRTRXhwLnNlbGVjdCgpIHVubGVzcyBfLmlzTmlsKEBjdXJyZW50U0V4cClcblxuZWRpdG9yID0gbmV3IEVkaXRvclxuXG5LZXkgPVxuICBMRUZUOiA3MlxuICBSSUdIVDogNzZcbiAgVVA6IDc1XG4gIERPV046IDc0XG4gIFNQQUNFOiAzMlxuICBFTlRFUjogMTNcblxuY2xhc3MgS2V5SGFuZGxlclxuICBjb25zdHJ1Y3RvcjogKEBlZGl0b3IpIC0+XG4gICAgRXZlbnRzLndyYXAod2luZG93KS5hZGRFdmVudExpc3RlbmVyICdrZXlkb3duJywgKGV2ZW50KSA9PlxuICAgICAgY29uc29sZS5sb2cgJ2tleSBjb2RlJywgZXZlbnQua2V5Q29kZVxuICAgICAgaWYgZXZlbnQua2V5Q29kZSBpcyBLZXkuRE9XTlxuICAgICAgICBAZWRpdG9yLmdvSW4oKVxuICAgICAgaWYgZXZlbnQua2V5Q29kZSBpcyBLZXkuVVBcbiAgICAgICAgQGVkaXRvci5nb091dCgpXG4gICAgICBpZiBldmVudC5rZXlDb2RlIGlzIEtleS5SSUdIVFxuICAgICAgICBAZWRpdG9yLmdvTmV4dCgpXG4gICAgICBpZiBldmVudC5rZXlDb2RlIGlzIEtleS5MRUZUXG4gICAgICAgIEBlZGl0b3IuZ29QcmV2aW91cygpXG5cbmtleUhhbmRsZXIgPSBuZXcgS2V5SGFuZGxlcihlZGl0b3IpXG5cbmNvbnNvbGUubG9nICdydW5uaW5nLi4uJ1xuIl19
//# sourceURL=/Users/gvieira/Dropbox/design/Projects/Hare/hare.io/Framer/Project/src_coffee/main.coffee